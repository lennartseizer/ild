---
layout: page
title: Formulas
---

<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mixed-Effects Models – von OLS zu LME/LMM</title>

  <!-- MathJax v3 (chtml + color) -->
  <script>
    window.MathJax = {
      loader: { load: ['[tex]/color'] },
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$']],
        packages: { '[+]': ['color','noerrors','noundefined'] }
      },
      chtml: { scale: 1, matchFontHeight: true }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f9fafb;
      color: #111827;
      margin: 0;
    }
    .wrap {
      max-width: 960px;
      margin: 2rem auto;
      padding: 0 1rem 3rem;
    }
    h1 { font-size: 2rem; margin-bottom: 1rem; }
    h2 { font-size: 1.4rem; margin: 2rem 0 .5rem; }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      box-shadow: 0 4px 14px rgba(0,0,0,.08);
      margin-top: 1rem;
    }
    .legend {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      font-size: .95rem;
      margin: 1rem 0 2rem;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      border: 1px solid #e5e7eb;
      border-radius: 999px;
      padding: .2rem .6rem;
      background: #fff;
    }
    .dot {
      width: .8rem;
      height: .8rem;
      border-radius: 50%;
    }
    .dot.fixed { background: blue; }
    .dot.random { background: green; }
    .dot.error { background: red; }
    .dot.matrix { background: gray; }
    .note { font-size: .9rem; color: #6b7280; }
    .code {
      font-family: monospace;
      background: #0b1020;
      color: #d4d4d4;
      padding: .5rem .8rem;
      border-radius: 6px;
      margin-top: .5rem;
      display: inline-block;
    }
       .code-block {
      font-family: monospace;
      background: #111827;
      color: #f3f4f6;
      padding: .8rem 1rem;
      border-radius: 8px;
      margin-top: .5rem;
      overflow-x: auto;
      line-height: 1.4;
    }
    .tag {
      display: inline-flex;
      align-items: center;
      gap: .35rem;
      padding: .25rem .55rem;
      border-radius: 999px;
      font-size: .85rem;
      font-weight: 600;
      color: #0f172a;
      background: #e2e8f0;
      margin-right: .35rem;
    }
    .tag::before {
      content: '';
      width: .7rem;
      height: .7rem;
      border-radius: 50%;
      display: inline-block;
    }
    .tag.fixed::before { background: blue; }
    .tag.error::before { background: red; }
    .tag.matrix::before { background: gray; }
  </style>
</head>
<body>
  <div class="wrap">

    <img src="https://upload.wikimedia.org/wikipedia/commons/1/12/Mixedandfixedeffects.jpg" 
      alt="Fixed, mixed, and random effects influence linear regression models.">
    
    <!-- Legende -->
    <div class="legend">
      <span class="chip"><span class="dot fixed"></span>Coefficients</span>
      <span class="chip"><span class="dot error"></span>Residuals</span>
      <span class="chip"><span class="dot matrix"></span>Predictors</span>
    </div>



    
    <h2>1) Linear model (OLS)</h2>
      <div class="card">
        $$
        y_{i}
        = \color{blue}\beta_{0}
        \color{black}+ \color{blue}\beta_{1}\color{gray} x
        \color{black}+ \color{red}\varepsilon_{i}
        $$
      </div>
    <div class="card">
      <pre class="code-block" style="font-size: 12px;">
> mod <- lm(y ~ b, data = data)
> summary(mod)
  
Call:
lm(formula = y ~ x, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1254 -0.4217 -0.0241  0.4305  1.2876                     # <-- εi 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    2.4806     0.1372  18.087  &lt;2e-16 ***      # <-- β0
x              1.2164     0.0725  16.782  &lt;2e-16 ***      # <-- β1
---
Residual standard error: 0.612 on 98 degrees of freedom
Multiple R-squared:  0.742, Adjusted R-squared:  0.738 
F-statistic: 281.6 on 1 and 98 DF,  p-value: &lt; 2.2e-16
      </pre>
    </div>

    <h2>2) Random Intercept Mixed-Effects-Model </h2>
    <div class="card">
      $$
      Level&ensp;1: y_{ij}
      = \color{blue}\beta_{0j}
      \color{black}+ \color{blue}\beta_{1}\color{gray}w_{ij}
      \color{black}+ \color{red}\varepsilon_{ij}
      $$
      $$
      Level&ensp;2: \color{blue}\beta_{0j}
      \color{black}= \color{blue}\gamma_{00}
      \color{black}+ \color{blue}\gamma_{01}\color{gray}b_{j}
      \color{black}+ \color{red}u_{0j}
      $$
      <br>
      $$
      \begin{align*}
      Complete: y_{ij}
      = \color{blue}\gamma_{00}\color{black}+\color{blue}\gamma_{01}\color{gray}b_{j}\color{black}+\color{red}u_{0j} \\
      \color{black}+\color{blue}\beta_{1}\color{gray}w_{ij}\color{black}+\color{red}\varepsilon_{ij}
      \end{align*}
      $$
    </div>
    <div class="card">
      <pre class="code-block" style="font-size: 12px;">
> fit <- nlme::lme(
             fixed   = y ~ w + b,
             random  = ~ 1 | id,
             data    = data)
> summary(fit)
  
Linear mixed-effects model fit by REML
 Data: data 
       AIC      BIC    logLik
     512.3    523.8   -252.1

Random effects:
 Formula: ~1 | id
        (Intercept)  Residual
StdDev:     0.71      0.95                            # <-- u0j, εij

Fixed effects: y ~ w 
               Value Std.Error  DF   t-value p-value
(Intercept)    1.92     0.38    38    5.05   <0.001      # <-- γ00 
w              0.46     0.08   160    5.75   <0.001      # <-- β1
b              0.46     0.08   160    5.75   <0.001      # <-- γ01
      </pre>
    </div>

    <h2>3) Random Slope Mixed-Effects-Model</h2>
    <div class="card">
      $$
      Level&ensp;1: y_{ij}
      = \color{blue}\beta_{0j}
      \color{black}+ \color{blue}\beta_{1}\color{gray}w_{ij}
      \color{black}+ \color{red}\varepsilon_{ij}
      $$
      $$
      Level&ensp;2: \color{blue}\beta_{0j}
      \color{black}= \color{blue}\gamma_{00}
      \color{black}+ \color{blue}\gamma_{01}\color{gray}b_{j}
      \color{black}+ \color{red}u_{0j}
      $$
      $$
      Level&ensp;2: \color{blue}\beta_{1j}
      \color{black}= \color{gray}\gamma_{10}
      \color{black}+ \color{red}u_{1j}
      $$
      <br>
      $$
      \begin{align*}
      Complete: y_{ij}
      = \color{blue}\gamma_{00}\color{black}+\color{blue}\gamma_{01}\color{gray}b_{j}\color{black}+\color{red}u_{0j} \\
      \color{black}+\color{blue}\gamma_{10}\color{gray}w_{ij} \color{black}+\color{blue}\gamma_{10}\color{gray}b_{j}\color{gray}w_{ij} \color{black}+\color{red}{u_{1j}}\color{gray}w_{ij}
      \color{black}+ \color{red}\varepsilon_{ij}
      \end{align*}
      $$
      <center>
      <div class="code" style="font-size: 15px";>
        lme4::lmer(y ~ w + (w | id), data=data) <br>
        nlme::lme(y ~ w, random = ~ w | id, data=data)
      </div>
      </center>
    </div>

    <h2>3) Zufälliger Interzept (RI)</h2>
    <div class="card">
      $$
      y_{ij} = \color{blue}{\beta_0} + \color{blue}{\beta_1} x_{ij}
      + \color{green}{b_{0j}} + \color{red}{\varepsilon_{ij}}
      $$
      <div class="code">
        # lme4
        lmer(y ~ 1 + (1 | id), data=data)
        # nlme
        lme(y ~ 1, random = ~ 1 | id, data=data)</div>
    </div>

    <h2>4) Zufälliger Interzept &amp; Steigung (RI+RS)</h2>
    <div class="card">
      $$
      y_{ij} = (\color{blue}{\beta_0}+\color{green}{b_{0j}})
      + (\color{blue}{\beta_1}+\color{green}{b_{1j}})x_{ij}
      + \color{red}{\varepsilon_{ij}}
      $$
      <div class="code">lme4: y ~ 1 + x + (1 + x | gruppe)</div>
    </div>

    <h2>5) Marginale Verteilung</h2>
    <div class="card">
      $$
      \mathbf y \sim \mathcal N\!\Big(
      \color{gray}{\mathbf X}\,\color{blue}{\boldsymbol\beta},\;
      \color{gray}{\mathbf Z}\,\mathbf G\,\color{gray}{\mathbf Z}^{\top} + \mathbf R
      \Big)
      $$
    </div>
  </div>
</body>
</html>

