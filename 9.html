---
layout: page
title: Formulas
---

<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mixed-Effects Models – von OLS zu LME/LMM</title>

  <!-- MathJax v3 (chtml + color) -->
  <script>
    window.MathJax = {
      loader: { load: ['[tex]/color'] },
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$']],
        packages: { '[+]': ['color','noerrors','noundefined'] }
      },
      chtml: { scale: 1, matchFontHeight: true }
    };
  </script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    body {
      font-family: system-ui, sans-serif;
      background: #f9fafb;
      color: #111827;
      margin: 0;
    }
    .wrap {
      max-width: 960px;
      margin: 2rem auto;
      padding: 0 1rem 3rem;
    }
    h1 { font-size: 2rem; margin-bottom: 1rem; }
    h2 { font-size: 1.4rem; margin: 2rem 0 .5rem; }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 1rem 1.25rem;
      box-shadow: 0 4px 14px rgba(0,0,0,.08);
      margin-top: 1rem;
    }
    .legend {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      font-size: .95rem;
      margin: 1rem 0 2rem;
    }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: .4rem;
      border: 1px solid #e5e7eb;
      border-radius: 999px;
      padding: .2rem .6rem;
      background: #fff;
    }
    .dot {
      width: .8rem;
      height: .8rem;
      border-radius: 50%;
    }
    .dot.fixed { background: blue; }
    .dot.random { background: green; }
    .dot.error { background: red; }
    .dot.matrix { background: gray; }
    .note { font-size: .9rem; color: #6b7280; }
    .code {
      font-family: monospace;
      background: #0b1020;
      color: #d4d4d4;
      padding: .5rem .8rem;
      border-radius: 6px;
      margin-top: .5rem;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- Legende -->
    <div class="legend">
      <span class="chip"><span class="dot fixed"></span>Coefficients</span>
      <span class="chip"><span class="dot error"></span>Residuals</span>
      <span class="chip"><span class="dot matrix"></span>Predictors</span>
    </div>

    <h2>1) Linear model (OLS)</h2>
    <div class="card">
      $$
      y_{i}
      = \color{blue}\beta_{0}
      \color{black}+ \color{blue}\beta_{1}\color{gray} x
      \color{black}+ \color{red}\varepsilon_{i}
      $$
    </div>
    <div class="card">
      <center>
      <div class="code" style="font-size: 15px";>
        lm(y ~ x, data = data)
      </div>
      </center>
    </div>

    <h2>2) Random Intercept Mixed-Effects-Model </h2>
    <div class="card">
      $$
      Level&ensp;1: y_{ij}
      = \color{blue}\beta_{0j}
      \color{black}+ \color{blue}\beta_{1}\color{gray}w_{ij}
      \color{black}+ \color{red}\varepsilon_{ij}
      $$
      $$
      Level&ensp;2: \color{blue}\beta_{0j}
      \color{black}= \color{blue}\gamma_{00}
      \color{black}+ \color{blue}\gamma_{01}\color{gray}b_{j}
      \color{black}+ \color{red}u_{0j}
      $$
      $$
      Level&ensp;2: \color{blue}\beta_{1j}
      \color{black}= \color{gray}\gamma_{10}
      \color{black}+ \color{red}u_{1j}
      $$
    </div>
    <div class="card">
      $$
      \begin{align*}
      Complete: y_{ij}
      = \color{blue}\gamma_{00}\color{black}+\color{blue}\gamma_{01}\color{gray}b_{j}\color{black}+\color{red}u_{0j} \\
      \color{black}+\color{blue}\gamma_{10}\color{gray}w_{ij} \color{black}+\color{blue}\gamma_{10}\color{gray}b_{j}\color{gray}w_{ij} \color{black}+\color{red}{u_{1j}}\color{gray}w_{ij}
      \color{black}+ \color{red}\varepsilon_{ij}
      \begin{align*}
      $$
    </div>
    <div class="card">
      <center>
      <div class="code" style="font-size: 15px";>
        lme4::lmer(y ~ w + (1 | id), data=data) <br>
        nlme::lme(y ~ w, random = ~ 1 | id, data=data)
      </div>
      </center>
    </div>

    <h2>3) Random Slope Mixed-Effects-Model</h2>
    <div class="card">
      $$
      y_{ij} = \color{blue}{\beta_0} + \color{blue}{\beta_1} x_{ij}
      + \color{green}{b_{0j}} + \color{red}{\varepsilon_{ij}}
      $$
      <center>
      <div class="code" style="font-size: 15px";>
        lme4::lmer(y ~ w + (w | id), data=data) <br>
        nlme::lme(y ~ w, random = ~ w | id, data=data)
      </div>
      </center>
    </div>

    <h2>3) Zufälliger Interzept (RI)</h2>
    <div class="card">
      $$
      y_{ij} = \color{blue}{\beta_0} + \color{blue}{\beta_1} x_{ij}
      + \color{green}{b_{0j}} + \color{red}{\varepsilon_{ij}}
      $$
      <div class="code">
        # lme4
        lmer(y ~ 1 + (1 | id), data=data)
        # nlme
        lme(y ~ 1, random = ~ 1 | id, data=data)</div>
    </div>

    <h2>4) Zufälliger Interzept &amp; Steigung (RI+RS)</h2>
    <div class="card">
      $$
      y_{ij} = (\color{blue}{\beta_0}+\color{green}{b_{0j}})
      + (\color{blue}{\beta_1}+\color{green}{b_{1j}})x_{ij}
      + \color{red}{\varepsilon_{ij}}
      $$
      <div class="code">lme4: y ~ 1 + x + (1 + x | gruppe)</div>
    </div>

    <h2>5) Marginale Verteilung</h2>
    <div class="card">
      $$
      \mathbf y \sim \mathcal N\!\Big(
      \color{gray}{\mathbf X}\,\color{blue}{\boldsymbol\beta},\;
      \color{gray}{\mathbf Z}\,\mathbf G\,\color{gray}{\mathbf Z}^{\top} + \mathbf R
      \Big)
      $$
    </div>
  </div>
</body>
</html>

